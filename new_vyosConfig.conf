firewall {
    all-ping enable
    broadcast-ping disable
    config-trap disable
    ipv6-receive-redirects disable
    ipv6-src-route disable
    ip-src-route disable
    log-martians enable
    receive-redirects disable
    send-redirects enable
    source-validation disable
    syn-cookies enable
    twa-hazards-protection disable

    name ALLOW-ESTABLISHED {
        default-action reject
        rule 10 {
            action accept
            state {
                established enable
                related enable
            }
        }
        rule 20 {
            action accept
            description "Allow PPTP access from the Internet"
            destination {
                port 1723
            }
            protocol tcp
        }
    }
}

interfaces {
# WAN
    ethernet eth0 {
        address 149.166.26.135/24
        hw-id 00:50:56:9f:77:fd
        duplex auto
        speed auto
        smp-affinity auto
    }
# 192.168.54.X has nothing
# 192.168.55.X has one lease called photon-machine at 192.168.55.58
    ethernet eth1 {
        address 192.168.54.2/24
        address 192.168.55.2/24
        description "VLAN55"
        hw-id 00:50:56:9f:0c:4a
        duplex auto
        speed auto
        smp-affinity auto
    }
# LAN
    ethernet eth2 {
        address 10.5.7.2/24
        address 192.168.57.2/24
        description "VLAN57"
        hw-id 00:50:56:9f:1f:72
        duplex auto
        speed auto
        smp-affinity auto
        firewall {
            in {
                name eth0-Inbound
            }
            local
            out {
                name eth0-Outbound
            }
        }
    }
# 10.20.20.1 has only this router
# 192.168.20.X has nothing
    ethernet eth3 {
        address 10.20.20.2/24
        address 192.168.20.2/24
        description "VLAN20"
        hw-id 00:50:56:9f:3c:2d
        duplex auto
        speed auto
        smp-affinity auto
    }
    ethernet eth4 {
# 10.10.10.X has nothing
# 192.168.10.X has nothing
        address 10.10.10.2/24
        address 192.168.10.2/24
        description "VLAN10"
        hw-id 00:50:56:9f:41:3e
        duplex auto
        speed auto
        smp-affinity auto
    }
# TEST
    ethernet eth5 {
        description "TESTING"
        hw-id 00:50:56:9f:76:96
        duplex auto
        speed auto
        smp-affinity auto
    }
    loopback lo
}

nat {
    destination
    source {
        rule 10 {
            destination {
                address 0.0.0.0/0
            }
            outbound-interface eth0
            source {
                address 192.168.57.0/24
            }
            translation {
                address 149.166.26.135
            }
        }
        rule 100 {
            destination {
                address 0.0.0.0/0
            }
            outbound-interface eth0
            source {
                address 192.168.55.0/24
            }
            translation {
                address 149.166.26.135
            }
        }
    }
}

service {
    ssh {
        port 22
        listen-address 10.5.7.2
        listen-address 192.168.57.2
    }
}

system {
    config-management {
        commit-revisions 20
    }
    console {
        device ttyS0 {
            speed 9600
        }
    }
    gateway-address 149.166.26.1
    host-name vyos
    login {
        banner pre-login "ALERT! Your IP, Login Time, and Username are monitored. This service is restricted to authorized users only. All activities on this system are being logged."
        user vyos {
            authentication {
                encrypted-password "$1$OpdUTrlZ$DO9UEmN6xNz/7tJrwhxl/1"
            }
            level admin
        }
    }
    ntp {
        server 0.pool.ntp.org
        server 1.pool.ntp.org
        server 2.pool.ntp.org
    }
    package {
        auto-sync 1
        repository community {
            components main
            distribution helium
            url http://packages.vyos.net/vyos
        }
    }
    syslog {
        global {
            facility all {
                level notice
            }
            facility protocols {
                level debug
            }
        }
    }
    time-zone US/East-Indiana
}
